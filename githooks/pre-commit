#!/bin/bash
set -eu

osname="$(uname --operating-system)"
if [[ "$osname" == *"Linux" ]]; then
	JenkinsJobs/Linux/Cloudundancy-PyUtils-SonarQube.sh
   JenkinsJobs/Linux/Cloudundancy-Debug-Clang.sh
elif [ "$osname" == "Msys" ]; then
	powershell.exe JenkinsJobs/Windows/Cloudundancy-PyUtils-SonarQube.ps1
   powershell.exe JenkinsJobs/Windows/Cloudundancy-Debug.ps1
fi
jenkinsJobExitCode=$?
if [ "$jenkinsJobExitCode" -ne 0 ]; then
   echo "<><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><>"
   echo "pre-commit: Jenkins job failed with exit code $jenkinsJobExitCode. Disallowing commit."
   echo "<><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><>"
   exit 1
fi
echo "***************************************************"
echo "pre-commit: Jenkins job succeeded. Allowing commit."
echo "***************************************************"
